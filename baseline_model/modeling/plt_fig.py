import numpy as np
import matplotlib.pyplot as plt


epoch_list = [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91,
 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
##bce
Loss_list = [2.5035, 2.8505, 2.7885, 1.8804, 1.8729, 1.9079, 1.8132, 1.8251, 2.0871, 2.2067, 1.9899, 1.3367, 1.1405, 1.0784, 0.9155, 0.8631, 0.7846, 0.7601, 0.7298, 0.7317, 0.6945, 0.6597, 0.6559, 0.623, 0.6322, 0.5984,
0.5659, 0.5396, 0.5515, 0.4975, 0.482, 0.4804, 0.469, 0.4554, 0.4355, 0.4448, 0.4163, 0.3934, 0.4108, 0.3935, 0.337, 0.3522, 0.3881, 0.3404, 0.3819, 0.3368, 0.3326, 0.3236, 0.2988, 0.3239, 0.3095, 0.2909,
0.2902, 0.2919, 0.2591, 0.2789, 0.2635, 0.2636, 0.2374, 0.2459, 0.2546, 0.2583, 0.2509, 0.2346, 0.2627, 0.2086, 0.2214, 0.2053, 0.2385, 0.2159, 0.2274, 0.2427, 0.2727, 0.2072, 0.1915, 0.1916, 0.1831, 0.1985, 0.1895,
0.1917]

dice_list = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1635, 0.1635, 0.1635, 0.1635, 0.1635, 0.1635, 0.1635, 0.1635, 0.1635, 0.1635, 0.4118, 0.4118, 0.4118, 0.4118, 0.4118, 0.4118, 0.4118, 0.4118, 0.4118, 0.4118,
0.6108, 0.6108, 0.6108, 0.6108, 0.6108, 0.6108, 0.6108, 0.6108, 0.6108, 0.6108, 0.7362, 0.7362, 0.7362, 0.7362, 0.7362, 0.7362, 0.7362, 0.7362, 0.7362, 0.7362, 0.852, 0.852, 0.852, 0.852, 0.852, 0.852,
0.852, 0.852, 0.852, 0.852, 0.8044, 0.8044, 0.8044, 0.8044, 0.8044, 0.8044, 0.8044, 0.8044, 0.8044, 0.8044, 0.8845, 0.8845, 0.8845, 0.8845, 0.8845, 0.8845, 0.8845, 0.8845, 0.8845, 0.8845, 0.8975]
#dice
# Loss_list= [2.5383, 2.5201, 4.1956, 1.599, 1.5851, 1.4998, 2.8093, 3.1252, 3.2362, 3.1647, 2.8266, 2.0019, 1.9233, 1.8847, 1.7578, 1.5517, 1.1044, 0.9584, 0.7974, 0.855, 0.7163, 0.6887, 0.6953, 0.6569, 0.6415, 0.6305,
# 0.5931, 0.5829, 0.5575, 0.5451, 0.5169, 0.5284, 0.4835, 0.4679, 0.4944, 0.4436, 0.4235, 0.4384, 0.4173, 0.3915, 0.4069, 0.3888, 0.376, 0.3523, 0.3521, 0.3633, 0.318, 0.3373, 0.316, 0.2843, 0.3187, 0.2959, 0.2896, 0.3098,
# 0.2764, 0.2735, 0.2503, 0.3136, 0.2655, 0.2512, 0.2247, 0.2325, 0.2623, 0.2499, 0.2154, 0.2212, 0.2929, 0.2588, 0.2437, 0.2289, 0.2092, 0.3095, 0.2282, 0.2253, 0.1911, 0.2228, 0.194, 0.1946,
# 0.1944, 0.224]
# dice_list = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1166, 0.1166, 0.1166, 0.1166, 0.1166, 0.1166, 0.1166, 0.1166, 0.1166, 0.1166, 0.5612, 0.5612, 0.5612, 0.5612, 0.5612, 0.5612, 0.5612, 0.5612, 0.5612, 0.5612,
# 0.6871, 0.6871, 0.6871, 0.6871, 0.6871, 0.6871, 0.6871, 0.6871, 0.6871, 0.6871, 0.7425, 0.7425, 0.7425, 0.7425, 0.7425, 0.7425, 0.7425, 0.7425, 0.7425, 0.7425, 0.8539, 0.8539, 0.8539, 0.8539, 0.8539,
# 0.8539, 0.8539, 0.8539, 0.8539, 0.8539, 0.8844, 0.8844, 0.8844, 0.8844, 0.8844, 0.8844, 0.8844, 0.8844, 0.8844, 0.8844, 0.8568, 0.8568, 0.8568, 0.8568, 0.8568, 0.8568, 0.8568, 0.8568, 0.8568, 0.8568, 0.943]

#0.5*bce+dice
# loss_list = [3.1671, 3.1193, 2.7628, 2.5262, 2.4698, 2.6225, 3.3683, 2.4717, 2.2339, 2.034, 1.8991, 1.8866, 1.8256, 1.765, 1.6775, 1.6376, 1.6214, 1.55, 1.5303, 1.4565, 1.4165, 1.3699, 1.3054, 1.2771, 1.2036, 1.1659,
# 1.1261, 1.1159, 1.0336, 1.0293, 0.9814, 0.8964, 0.828, 0.7764, 0.7629, 0.7463, 0.6704, 0.6377, 0.6111, 0.6073, 0.6051, 0.5687, 0.5221, 0.4993, 0.4869, 0.4952, 0.4818, 0.4705, 0.4081, 0.3887, 0.3713, 0.3575,
# 0.3532, 0.3434, 0.351, 0.4942, 0.4566, 0.4466, 0.3777, 0.3238, 0.3012, 0.3035, 0.269, 0.3175, 0.2958, 0.2744, 0.2521, 0.2536, 0.2439, 0.2947, 0.2625, 0.3431, 0.2593, 0.2506, 0.2222, 0.218, 0.2124, 0.2321, 0.2139,
#  0.2198, 0.2131, 0.2329, 0.2256, 0.2046, 0.235, 0.212, 0.19, 0.1855, 0.199, 0.1968, 0.176]
# Loss_list = [i/2 for i in loss_list]
# dice_list = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1446, 0.1446, 0.1446, 0.1446, 0.1446, 0.1446, 0.1446, 0.1446, 0.1446, 0.1446, 0.4084, 0.4084, 0.4084, 0.4084, 0.4084, 0.4084, 0.4084, 0.4084, 0.4084,
# 0.4084, 0.6842, 0.6842, 0.6842, 0.6842, 0.6842, 0.6842, 0.6842, 0.6842, 0.6842, 0.6842, 0.7233, 0.7233, 0.7233, 0.7233, 0.7233, 0.7233, 0.7233, 0.7233, 0.7233, 0.7233, 0.873, 0.873, 0.873, 0.873, 0.873, 0.873,
# 0.873, 0.873, 0.873, 0.873, 0.9243, 0.9243, 0.9243, 0.9243, 0.9243, 0.9243, 0.9243, 0.9243, 0.9243, 0.9243, 0.9079, 0.9079, 0.9079, 0.9079, 0.9079, 0.9079, 0.9079, 0.9079, 0.9079, 0.9079, 0.9186, 0.9186, 0.9186
# , 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9453, 0.9453]
##0.1bce+dice epoch120
# Loss_list = [2.2938, 1.3057, 1.5945, 1.5404, 1.6403, 1.106, 0.9146, 0.8335, 0.8185, 0.8215, 0.8056, 0.7507, 0.7753, 0.7416, 0.7157, 0.6917, 0.6463, 0.6085, 0.5655, 0.5802, 0.5747, 0.5308, 0.5131, 0.5575, 0.4694, 0.4293,
# 0.4143, 0.4333, 0.4058, 0.399, 0.359, 0.3378, 0.3915, 0.3698, 0.3458, 0.3622, 0.3148, 0.3291, 0.3717, 0.3219, 0.3146, 0.3138, 0.2543, 0.3607, 0.2841, 0.2589, 0.3069, 0.2643, 0.2425, 0.242, 0.2413, 0.2507,
# 0.2281, 0.2086, 0.2907, 0.2216, 0.2843, 0.2332, 0.2411, 0.2997, 0.2224, 0.1897, 0.185, 0.1925, 0.1767, 0.1984, 0.2036, 0.2557, 0.2253, 0.1913, 0.1772, 0.1742, 0.1915, 0.3044, 0.214, 0.231, 0.1828, 0.1798, 0.1644
# , 0.1703]
# dice_list = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3006, 0.3006, 0.3006, 0.3006, 0.3006, 0.3006, 0.3006, 0.3006, 0.3006, 0.3006, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
# 0.5507, 0.7115, 0.7115, 0.7115, 0.7115, 0.7115, 0.7115, 0.7115, 0.7115, 0.7115, 0.7115, 0.8626, 0.8626, 0.8626, 0.8626, 0.8626, 0.8626, 0.8626, 0.8626, 0.8626, 0.8626, 0.8893, 0.8893, 0.8893, 0.8893, 0.8893,
# 0.8893, 0.8893, 0.8893, 0.8893, 0.8893, 0.9301, 0.9301, 0.9301, 0.9301, 0.9301, 0.9301, 0.9301, 0.9301, 0.9301, 0.9301, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9186, 0.9516]

# Loss_list = [2.2762, 2.8359, 1.6358, 2.5484, 1.4237, 0.9727, 0.9265, 0.8768, 0.8343, 0.8143, 0.8342, 0.7913, 0.7506, 0.7331, 0.7228, 0.7237, 0.644, 0.6315, 0.6094, 0.594, 0.5388, 0.5412, 0.5425, 0.4891, 0.4791, 0.4594,
# 0.4307, 0.4384, 0.4062, 0.3988, 0.4294, 0.3669, 0.3872, 0.3488, 0.37, 0.3476, 0.3301, 0.3175, 0.3241, 0.3255, 0.3263, 0.3604, 0.3007, 0.2722, 0.295, 0.2587, 0.2781, 0.2638, 0.3111, 0.2679, 0.2486, 0.2275,
# 0.2195, 0.2325, 0.2429, 0.2376, 0.2245, 0.2734, 0.2077, 0.2504, 0.2132, 0.2089, 0.2033, 0.1951, 0.182, 0.1989, 0.2199, 0.2067, 0.2043, 0.1799, 0.1926, 0.2031, 0.1927, 0.219, 0.1998, 0.1921, 0.1969, 0.1782, 0.1734
# , 0.1871]
epoch_list = np.load("./tmp/epoch_130_a2_0.05data_150epoch_list.npy")
Loss_list = np.load("./tmp/epoch_130_a2_0.05data_150Loss_list.npy")
dice_list = np.load("./tmp/epoch_130_a2_0.05data_150dice_list.npy")
Loss_list.tolist()
dice_list.tolist()



ax = plt.gca()
ax.set_ylim(0.0, 3.2)
plt.plot(epoch_list, Loss_list, 'r-',label="loss")
plt.plot(epoch_list, dice_list, 'b-',label="dice")
plt.title('Training loss&dice vs. epoches')
plt.xlabel("epoches")
plt.ylabel('Training loss&dice')
plt.legend()
plt.show()